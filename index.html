<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة الموارد البشرية المتكامل</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Segoe UI', 'Cairo', Tahoma, Geneva, Verdana, sans-serif; 
            overflow-x: hidden;
        }
        
        /* Sidebar Styles */
        .sidebar {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(100%);
            backdrop-filter: blur(10px);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .sidebar.open {
            transform: translateX(0);
        }
        
        .sidebar-overlay {
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            visibility: hidden;
        }
        
        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        @media (min-width: 1024px) {
            .sidebar {
                transform: translateX(0) !important;
                position: relative !important;
                backdrop-filter: none;
                border-left: none;
                border-left: 1px solid #e5e7eb;
            }
            .sidebar-overlay {
                display: none !important;
            }
            .main-content {
                margin-right: 280px;
            }
        }
        
        /* Professional Animations */
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        .animate-slide-up {
            animation: slideUp 0.4s ease-out;
        }
        
        .animate-scale-in {
            animation: scaleIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        /* Navigation Styles */
        .nav-btn {
            position: relative;
            overflow: hidden;
        }
        
        .nav-btn:before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            z-index: -1;
        }
        
        .nav-btn.active:before,
        .nav-btn:hover:before {
            width: 100%;
        }
        
        .nav-btn.active {
            color: white;
            background: linear-gradient(90deg, #667eea, #764ba2);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        /* Card Styles */
        .card-shadow { 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .card-shadow:hover {
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        /* Stats Cards */
        .stats-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }
        
        .dark .stats-card {
            background: linear-gradient(135deg, rgba(31, 41, 55, 0.9) 0%, rgba(31, 41, 55, 0.7) 100%);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        /* Form Elements */
        .input-group {
            position: relative;
        }
        
        .input-group label {
            position: absolute;
            top: -8px;
            right: 12px;
            background: white;
            padding: 0 8px;
            font-size: 12px;
            color: #667eea;
            font-weight: 600;
            z-index: 10;
        }
        
        .dark .input-group label {
            background: #1f2937;
            color: #a5b4fc;
        }
        
        /* Table Styles */
        .table-hover tbody tr {
            transition: all 0.2s ease;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(102, 126, 234, 0.05);
            transform: translateX(-2px);
        }
        
        .dark .table-hover tbody tr:hover {
            background-color: rgba(102, 126, 234, 0.1);
        }
        
        /* Loading Animation */
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Notification Styles */
        .notification {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
        }
        
        .notification.hide {
            transform: translateX(100%);
            opacity: 0;
        }
        
        /* Form Templates */
        .form-template {
            background: #fefefe;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }
        
        .form-template.dark {
            background: #1f2937;
            border: 1px solid #374151;
        }
        
        /* Section Content */
        .section-content {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
        }
        
        .section-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Progress Indicators */
        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 4px;
            border-radius: 2px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .grid-cols-md-2 {
                grid-template-columns: 1fr;
            }
            
            .text-responsive {
                font-size: 0.875rem;
            }
        }
        
        /* Print Styles */
        @media print {
            .no-print { display: none !important; }
            body { -webkit-print-color-adjust: exact; }
            .print-page { page-break-after: always; }
            .sidebar, .sidebar-overlay { display: none !important; }
            .main-content { margin-right: 0 !important; }
        }
        
        /* Dark Mode Enhancements */
        .dark {
            --tw-bg-opacity: 1;
            background-color: rgb(17 24 39 / var(--tw-bg-opacity));
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #5a6fd8;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { 
                        primary: '#667eea',
                        secondary: '#764ba2',
                        accent: '#f093fb'
                    },
                    fontFamily: { 
                        arabic: ['Segoe UI', 'Cairo', 'Tahoma', 'Geneva', 'Verdana', 'sans-serif'] 
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out',
                        'slide-up': 'slideUp 0.4s ease-out',
                        'scale-in': 'scaleIn 0.3s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            },
            darkMode: 'class'
        }
    </script>
</head>

<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-all duration-300">
    <!-- Loading Screen -->
    <div id="loading-screen" class="fixed inset-0 bg-white dark:bg-gray-900 z-50 flex items-center justify-center">
        <div class="text-center animate-scale-in">
            <div class="loading-spinner mx-auto mb-4"></div>
            <p class="text-lg font-medium text-primary">جاري تحميل النظام...</p>
            <div class="progress-bar w-32 mx-auto mt-4"></div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div id="sidebar-overlay" class="sidebar-overlay fixed inset-0 bg-black bg-opacity-60 z-40 lg:hidden"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar fixed right-0 top-0 h-full w-80 bg-white dark:bg-gray-800 shadow-2xl z-50 lg:w-72">
        <!-- Sidebar Header -->
        <div class="p-6 border-b border-gray-200 dark:border-gray-700">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3 space-x-reverse">
                    <div class="w-12 h-12 bg-gradient-to-br from-primary to-secondary rounded-xl flex items-center justify-center shadow-lg">
                        <i class="fas fa-users text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-lg font-bold text-primary">نظام الموارد البشرية</h2>
                        <p class="text-sm text-gray-500 dark:text-gray-400">الإدارة المتكاملة</p>
                    </div>
                </div>
                <button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Navigation Menu -->
        <nav class="p-4 space-y-1 flex-1 overflow-y-auto">
            <button onclick="showSection('dashboard')" class="nav-btn w-full text-right p-4 rounded-xl transition-all flex items-center space-x-3 space-x-reverse hover:bg-gray-50 dark:hover:bg-gray-700">
                <i class="fas fa-chart-dashboard w-5 text-lg"></i>
                <span class="font-medium">لوحة التحكم</span>
            </button>
            
            <button onclick="showSection('employees')" class="nav-btn w-full text-right p-4 rounded-xl transition-all flex items-center space-x-3 space-x-reverse hover:bg-gray-50 dark:hover:bg-gray-700">
                <i class="fas fa-users w-5 text-lg"></i>
                <span class="font-medium">إدارة الموظفين</span>
            </button>
            
            <button onclick="showSection('forms')" class="nav-btn w-full text-right p-4 rounded-xl transition-all flex items-center space-x-3 space-x-reverse hover:bg-gray-50 dark:hover:bg-gray-700">
                <i class="fas fa-file-alt w-5 text-lg"></i>
                <span class="font-medium">النماذج والتقارير</span>
            </button>
            

            
            <button onclick="showSection('settings')" class="nav-btn w-full text-right p-4 rounded-xl transition-all flex items-center space-x-3 space-x-reverse hover:bg-gray-50 dark:hover:bg-gray-700">
                <i class="fas fa-cog w-5 text-lg"></i>
                <span class="font-medium">إعدادات النظام</span>
            </button>
            
            <button onclick="showSection('backup')" class="nav-btn w-full text-right p-4 rounded-xl transition-all flex items-center space-x-3 space-x-reverse hover:bg-gray-50 dark:hover:bg-gray-700">
                <i class="fas fa-database w-5 text-lg"></i>
                <span class="font-medium">النسخ الاحتياطي</span>
            </button>
        </nav>

        <!-- Sidebar Footer -->
        <div class="p-4 border-t border-gray-200 dark:border-gray-700">
            <div class="bg-gradient-to-r from-primary to-secondary p-4 rounded-xl text-white text-center">
                <i class="fas fa-shield-alt text-2xl mb-2 block"></i>
                <p class="text-sm font-medium">نظام آمن ومحمي</p>
                <p class="text-xs opacity-90">تشفير البيانات 256-bit</p>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="main-content min-h-screen">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 sticky top-0 z-30">
            <div class="px-4 sm:px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <div>
                            <h1 id="page-title" class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white">لوحة التحكم</h1>
                            <p id="page-subtitle" class="text-sm text-gray-500 dark:text-gray-400">مرحباً بك في نظام إدارة الموارد البشرية</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <button onclick="toggleTheme()" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                            <i id="theme-icon" class="fas fa-moon text-gray-600 dark:text-gray-300"></i>
                        </button>
                        
                        <div class="hidden sm:flex items-center space-x-2 space-x-reverse bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300 px-3 py-1 rounded-full">
                            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                            <span class="text-sm font-medium">متصل</span>
                        </div>
                        
                        <div class="hidden md:block text-sm text-gray-500 dark:text-gray-400" id="current-time"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="p-4 sm:p-6">
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="section-content">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8">
                    <div class="stats-card p-4 sm:p-6 rounded-xl card-shadow animate-fade-in">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">إجمالي الموظفين</p>
                                <p id="total-employees" class="text-2xl sm:text-3xl font-bold text-primary">0</p>
                            </div>
                            <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-users text-blue-600 dark:text-blue-400 text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card p-4 sm:p-6 rounded-xl card-shadow animate-fade-in">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">النماذج المولدة</p>
                                <p id="total-forms" class="text-2xl sm:text-3xl font-bold text-green-600">0</p>
                            </div>
                            <div class="w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-file-alt text-green-600 dark:text-green-400 text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card p-4 sm:p-6 rounded-xl card-shadow animate-fade-in">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">الإجازات المعلقة</p>
                                <p id="pending-leaves" class="text-2xl sm:text-3xl font-bold text-yellow-600">0</p>
                            </div>
                            <div class="w-12 h-12 bg-yellow-100 dark:bg-yellow-900/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-clock text-yellow-600 dark:text-yellow-400 text-xl"></i>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card p-4 sm:p-6 rounded-xl card-shadow animate-fade-in">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-600 dark:text-gray-400">الموظفين الجدد</p>
                                <p id="new-employees" class="text-2xl sm:text-3xl font-bold text-purple-600">0</p>
                            </div>
                            <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-xl flex items-center justify-center">
                                <i class="fas fa-user-plus text-purple-600 dark:text-purple-400 text-xl"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions & Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl card-shadow">
                        <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center">
                            <i class="fas fa-bolt text-primary ml-2"></i>
                            إجراءات سريعة
                        </h3>
                        <div class="space-y-3">
                            <button onclick="showAddEmployeeModal()" class="w-full bg-gradient-to-r from-primary to-secondary hover:from-blue-600 hover:to-purple-600 text-white p-3 rounded-xl transition-all flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-user-plus"></i>
                                <span>إضافة موظف جديد</span>
                            </button>
                            <button onclick="showSection('forms')" class="w-full bg-gradient-to-r from-green-500 to-teal-500 hover:from-green-600 hover:to-teal-600 text-white p-3 rounded-xl transition-all flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-file-plus"></i>
                                <span>إنشاء نموذج جديد</span>
                            </button>
                            <button onclick="exportAllData()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white p-3 rounded-xl transition-all flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-download"></i>
                                <span>تصدير البيانات</span>
                            </button>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl card-shadow">
                        <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center">
                            <i class="fas fa-history text-primary ml-2"></i>
                            النشاط الأخير
                        </h3>
                        <div id="recent-activity" class="space-y-3">
                            <div class="flex items-center space-x-3 space-x-reverse p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                <div class="flex-1">
                                    <p class="text-sm text-gray-900 dark:text-white">تم تحميل النظام بنجاح</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">الآن</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 p-6 rounded-xl card-shadow">
                        <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white flex items-center">
                            <i class="fas fa-chart-pie text-primary ml-2"></i>
                            الإحصائيات السريعة
                        </h3>
                        <canvas id="quick-chart" width="300" height="200"></canvas>
                    </div>
                </div>
            </section>

            <!-- Employees Section -->
            <section id="employees-section" class="section-content">
                <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-4 sm:p-6 mb-6">
                    <!-- Header -->
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6 space-y-4 lg:space-y-0">
                        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white">إدارة الموظفين</h2>
                        <div class="flex flex-col sm:flex-row gap-3">
                            <button onclick="showAddEmployeeModal()" class="bg-primary hover:bg-blue-600 text-white px-4 py-2.5 rounded-lg transition-all flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-user-plus"></i>
                                <span>إضافة موظف</span>
                            </button>
                            <label class="bg-green-500 hover:bg-green-600 text-white px-4 py-2.5 rounded-lg transition-all cursor-pointer flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-file-import"></i>
                                <span>استيراد Excel</span>
                                <input type="file" id="excel-file" accept=".xlsx,.xls" class="hidden">
                            </label>
                            <button onclick="exportEmployeesToExcel()" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2.5 rounded-lg transition-all flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-file-export"></i>
                                <span>تصدير Excel</span>
                            </button>
                        </div>
                    </div>

                    <!-- Search and Filter -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="input-group">
                            <label>البحث</label>
                            <input type="text" id="search-employees" placeholder="ابحث عن موظف..." class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                        </div>
                        <div class="input-group">
                            <label>القسم</label>
                            <select id="filter-department" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                <option value="">جميع الأقسام</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>المسمى الوظيفي</label>
                            <select id="filter-position" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                <option value="">جميع المناصب</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label>الحالة</label>
                            <select id="filter-status" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                <option value="">جميع الحالات</option>
                                <option value="active">نشط</option>
                                <option value="inactive">غير نشط</option>
                                <option value="on-leave">في إجازة</option>
                            </select>
                        </div>
                    </div>

                    <!-- Employees Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-base text-right table-hover">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">
                                        <input type="checkbox" id="select-all-employees" class="rounded border-gray-300">
                                    </th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-primary transition-colors" onclick="sortTable('name')">
                                        الاسم <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:text-primary transition-colors" onclick="sortTable('employeeId')">
                                        الرقم الوظيفي <i class="fas fa-sort"></i>
                                    </th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">المسمى الوظيفي</th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">القسم</th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">تاريخ التعيين</th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">الحالة</th>
                                    <th class="px-4 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="employees-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                <!-- Employee rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>

                    <!-- Pagination -->
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mt-6 space-y-4 sm:space-y-0">
                        <div class="text-sm text-gray-700 dark:text-gray-300">
                            عرض <span id="showing-from">1</span> إلى <span id="showing-to">10</span> من <span id="total-records">0</span> موظف
                        </div>
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="previousPage()" id="prev-btn" class="px-3 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors">
                                السابق
                            </button>
                            <div id="page-numbers" class="flex space-x-1 space-x-reverse">
                                <!-- Page numbers will be inserted here -->
                            </div>
                            <button onclick="nextPage()" id="next-btn" class="px-3 py-2 text-sm bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 disabled:opacity-50 transition-colors">
                                التالي
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Forms Section -->
            <section id="forms-section" class="section-content">
                <div class="grid lg:grid-cols-4 gap-6">
                    <!-- Form Selection Panel -->
                    <div class="lg:col-span-1">
                        <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-6 sticky top-24">
                            <h3 class="text-xl font-bold mb-6 text-primary flex items-center">
                                <i class="fas fa-cogs ml-2"></i>
                                إعداد النموذج
                            </h3>
                            
                            <div class="space-y-6">
                                <div class="input-group">
                                    <label>اختر الموظف</label>
                                    <select id="employee-select" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                                        <option value="">اختر موظف...</option>
                                    </select>
                                </div>

                                <div>
                                    <h4 class="font-semibold mb-4 text-gray-900 dark:text-white">أنواع النماذج</h4>
                                    <div class="space-y-3">
                                        <!-- Form Type Buttons -->
                                        <button onclick="generateForm('start-work')" class="form-type-btn w-full p-4 text-right bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/40 border border-blue-200 dark:border-blue-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-briefcase text-blue-600 dark:text-blue-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">مباشرة عمل</div>
                                                    <div class="text-xs text-gray-500">إشعار بدء الخدمة</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('vacation')" class="form-type-btn w-full p-4 text-right bg-green-50 hover:bg-green-100 dark:bg-green-900/20 dark:hover:bg-green-900/40 border border-green-200 dark:border-green-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-umbrella-beach text-green-600 dark:text-green-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">طلب إجازة</div>
                                                    <div class="text-xs text-gray-500">طلب إجازة رسمي</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('salary-certificate')" class="form-type-btn w-full p-4 text-right bg-purple-50 hover:bg-purple-100 dark:bg-purple-900/20 dark:hover:bg-purple-900/40 border border-purple-200 dark:border-purple-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-file-invoice-dollar text-purple-600 dark:text-purple-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">شهادة راتب</div>
                                                    <div class="text-xs text-gray-500">إثبات راتب</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('experience-certificate')" class="form-type-btn w-full p-4 text-right bg-indigo-50 hover:bg-indigo-100 dark:bg-indigo-900/20 dark:hover:bg-indigo-900/40 border border-indigo-200 dark:border-indigo-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-medal text-indigo-600 dark:text-indigo-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">شهادة خبرة</div>
                                                    <div class="text-xs text-gray-500">إثبات خبرة</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('vacation-annual')" class="form-type-btn w-full p-4 text-right bg-teal-50 hover:bg-teal-100 dark:bg-teal-900/20 dark:hover:bg-teal-900/40 border border-teal-200 dark:border-teal-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-calendar-check text-teal-600 dark:text-teal-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">إجازة سنوية</div>
                                                    <div class="text-xs text-gray-500">طلب إجازة سنوية</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('vacation-sick')" class="form-type-btn w-full p-4 text-right bg-red-50 hover:bg-red-100 dark:bg-red-900/20 dark:hover:bg-red-900/40 border border-red-200 dark:border-red-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-medical text-red-600 dark:text-red-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">إجازة مرضية</div>
                                                    <div class="text-xs text-gray-500">طلب إجازة مرضية</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('vacation-unpaid')" class="form-type-btn w-full p-4 text-right bg-orange-50 hover:bg-orange-100 dark:bg-orange-900/20 dark:hover:bg-orange-900/40 border border-orange-200 dark:border-orange-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-pause text-orange-600 dark:text-orange-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">إجازة بدون راتب</div>
                                                    <div class="text-xs text-gray-500">طلب إجازة بدون راتب</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('custody-receive')" class="form-type-btn w-full p-4 text-right bg-cyan-50 hover:bg-cyan-100 dark:bg-cyan-900/20 dark:hover:bg-cyan-900/40 border border-cyan-200 dark:border-cyan-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-box text-cyan-600 dark:text-cyan-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">استلام عهدة</div>
                                                    <div class="text-xs text-gray-500">محضر استلام العهدات</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('custody-handover')" class="form-type-btn w-full p-4 text-right bg-amber-50 hover:bg-amber-100 dark:bg-amber-900/20 dark:hover:bg-amber-900/40 border border-amber-200 dark:border-amber-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-handshake text-amber-600 dark:text-amber-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">تسليم عهدة</div>
                                                    <div class="text-xs text-gray-500">محضر تسليم العهدات</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('service-termination')" class="form-type-btn w-full p-4 text-right bg-gray-50 hover:bg-gray-100 dark:bg-gray-900/20 dark:hover:bg-gray-900/40 border border-gray-200 dark:border-gray-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-user-times text-gray-600 dark:text-gray-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">إنهاء الخدمات</div>
                                                    <div class="text-xs text-gray-500">قرار إنهاء الخدمة</div>
                                                </div>
                                            </div>
                                        </button>

                                        <button onclick="generateForm('resignation')" class="form-type-btn w-full p-4 text-right bg-rose-50 hover:bg-rose-100 dark:bg-rose-900/20 dark:hover:bg-rose-900/40 border border-rose-200 dark:border-rose-800 rounded-lg transition-all">
                                            <div class="flex items-center space-x-3 space-x-reverse">
                                                <i class="fas fa-sign-out-alt text-rose-600 dark:text-rose-400"></i>
                                                <div class="text-right">
                                                    <div class="font-medium">الاستقالة</div>
                                                    <div class="text-xs text-gray-500">طلب استقالة</div>
                                                </div>
                                            </div>
                                        </button>
                                    </div>
                                </div>

                                <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                                    <h4 class="font-semibold mb-3 text-gray-900 dark:text-white">خيارات متقدمة</h4>
                                    <div class="space-y-3">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="include-logo" checked class="rounded border-gray-300 ml-2">
                                            <span class="text-sm">تضمين شعار الشركة</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="include-watermark" class="rounded border-gray-300 ml-2">
                                            <span class="text-sm">إضافة علامة مائية</span>
                                        </label>
                                        <label class="flex items-center">
                                            <input type="checkbox" id="auto-save" checked class="rounded border-gray-300 ml-2">
                                            <span class="text-sm">حفظ تلقائي</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Preview -->
                    <div class="lg:col-span-3">
                        <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-6">
                            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 no-print space-y-4 sm:space-y-0">
                                <h3 class="text-xl font-bold text-primary flex items-center">
                                    <i class="fas fa-eye ml-2"></i>
                                    معاينة النموذج
                                </h3>
                                <div class="flex flex-wrap gap-2">
                                    <button onclick="saveForm()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 space-x-reverse">
                                        <i class="fas fa-save"></i>
                                        <span>حفظ</span>
                                    </button>
                                    <button onclick="exportToPDF()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 space-x-reverse">
                                        <i class="fas fa-file-pdf"></i>
                                        <span>PDF</span>
                                    </button>
                                    <button onclick="printForm()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2 space-x-reverse">
                                        <i class="fas fa-print"></i>
                                        <span>طباعة</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div id="form-preview" class="min-h-screen form-template p-8 rounded-lg">
                                <div class="text-center text-gray-500 dark:text-gray-400 py-20">
                                    <i class="fas fa-file-alt text-6xl mb-4 opacity-50"></i>
                                    <h3 class="text-xl font-medium mb-2">اختر موظف ونوع النموذج</h3>
                                    <p>لعرض المعاينة والبدء في التحرير</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>



            <!-- Settings Section -->
            <section id="settings-section" class="section-content">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-6">
                        <h3 class="text-xl font-bold mb-6 text-gray-900 dark:text-white flex items-center">
                            <i class="fas fa-building text-primary ml-2"></i>
                            إعدادات الشركة
                        </h3>
                        <form id="company-settings-form" class="space-y-4">
                            <div class="input-group">
                                <label>اسم الشركة</label>
                                <input type="text" id="company-name" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all" value="شركة التقنية المتطورة">
                            </div>
                            <div class="input-group">
                                <label>عنوان الشركة</label>
                                <textarea id="company-address" rows="3" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">الرياض، المملكة العربية السعودية</textarea>
                            </div>
                            <div class="input-group">
                                <label>رقم الهاتف</label>
                                <input type="tel" id="company-phone" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all" value="920000000">
                            </div>
                            <div class="input-group">
                                <label>البريد الإلكتروني</label>
                                <input type="email" id="company-email" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all" value="info@company.com">
                            </div>
                            <button type="submit" class="w-full bg-gradient-to-r from-primary to-secondary hover:from-blue-600 hover:to-purple-600 text-white py-3 rounded-lg transition-all font-medium">
                                حفظ الإعدادات
                            </button>
                        </form>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-6">
                        <h3 class="text-xl font-bold mb-6 text-gray-900 dark:text-white flex items-center">
                            <i class="fas fa-cog text-primary ml-2"></i>
                            إعدادات النظام
                        </h3>
                        <div class="space-y-6">
                            <!-- System settings toggles -->
                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900 dark:text-white">التزامن التلقائي</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">مزامنة البيانات مع السحابة</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="auto-sync" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900 dark:text-white">التنبيهات</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">تنبيهات النظام والأحداث</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="notifications" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <div class="flex items-center justify-between">
                                <div>
                                    <h4 class="font-medium text-gray-900 dark:text-white">النسخ الاحتياطي التلقائي</h4>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">نسخ احتياطي يومي للبيانات</p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="auto-backup" checked class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Backup Section -->
            <section id="backup-section" class="section-content">
                <div class="bg-white dark:bg-gray-800 rounded-xl card-shadow p-6">
                    <h3 class="text-xl font-bold mb-6 text-gray-900 dark:text-white flex items-center">
                        <i class="fas fa-database text-primary ml-2"></i>
                        إدارة النسخ الاحتياطية
                    </h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4 p-6 bg-blue-50 dark:bg-blue-900/20 rounded-xl">
                            <h4 class="font-semibold text-gray-900 dark:text-white flex items-center">
                                <i class="fas fa-download text-blue-600 dark:text-blue-400 ml-2"></i>
                                إنشاء نسخة احتياطية
                            </h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">قم بإنشاء نسخة احتياطية من جميع البيانات</p>
                            <button onclick="createBackup()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg transition-colors flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-download"></i>
                                <span>إنشاء نسخة احتياطية</span>
                            </button>
                        </div>
                        
                        <div class="space-y-4 p-6 bg-green-50 dark:bg-green-900/20 rounded-xl">
                            <h4 class="font-semibold text-gray-900 dark:text-white flex items-center">
                                <i class="fas fa-upload text-green-600 dark:text-green-400 ml-2"></i>
                                استيراد نسخة احتياطية
                            </h4>
                            <p class="text-sm text-gray-600 dark:text-gray-400">استعادة البيانات من نسخة احتياطية</p>
                            <label class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg transition-colors cursor-pointer flex items-center justify-center space-x-2 space-x-reverse font-medium">
                                <i class="fas fa-upload"></i>
                                <span>اختيار ملف النسخة الاحتياطية</span>
                                <input type="file" id="backup-file" accept=".json" class="hidden">
                            </label>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Employee Modal -->
    <div id="add-employee-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-4xl w-full max-h-screen overflow-y-auto animate-scale-in">
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between">
                    <h3 class="text-xl font-bold text-primary flex items-center">
                        <i class="fas fa-user-plus ml-2"></i>
                        إضافة موظف جديد
                    </h3>
                    <button onclick="hideAddEmployeeModal()" class="p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <form id="add-employee-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="input-group">
                        <label>الاسم الكامل *</label>
                        <input type="text" id="emp-name" required class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>الرقم الوظيفي *</label>
                        <input type="text" id="emp-id" required class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>المسمى الوظيفي *</label>
                        <input type="text" id="emp-position" required class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>القسم *</label>
                        <select id="emp-department" required class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                            <option value="">اختر القسم</option>
                            <option value="تقنية المعلومات">تقنية المعلومات</option>
                            <option value="الموارد البشرية">الموارد البشرية</option>
                            <option value="المالية">المالية</option>
                            <option value="التسويق">التسويق</option>
                            <option value="المبيعات">المبيعات</option>
                            <option value="الإدارة">الإدارة</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>تاريخ التعيين *</label>
                        <input type="date" id="emp-hire-date" required class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>الراتب الأساسي</label>
                        <input type="number" id="emp-salary" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>رقم الهوية الوطنية</label>
                        <input type="text" id="emp-national-id" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>البريد الإلكتروني</label>
                        <input type="email" id="emp-email" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>رقم الهاتف</label>
                        <input type="tel" id="emp-phone" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group">
                        <label>الحالة الاجتماعية</label>
                        <select id="emp-marital-status" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                            <option value="">اختر الحالة</option>
                            <option value="أعزب">أعزب</option>
                            <option value="متزوج">متزوج</option>
                            <option value="مطلق">مطلق</option>
                            <option value="أرمل">أرمل</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>تاريخ الميلاد</label>
                        <input type="date" id="emp-birth-date" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
                    </div>
                    <div class="input-group md:col-span-2">
                        <label>العنوان</label>
                        <textarea id="emp-address" rows="3" class="w-full p-3 text-base border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all"></textarea>
                    </div>
                    <div class="md:col-span-2 flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-3 sm:space-x-reverse pt-4">
                        <button type="submit" class="flex-1 bg-gradient-to-r from-primary to-secondary hover:from-blue-600 hover:to-purple-600 text-white py-3 rounded-lg transition-all font-medium flex items-center justify-center space-x-2 space-x-reverse">
                            <i class="fas fa-save"></i>
                            <span>حفظ الموظف</span>
                        </button>
                        <button type="button" onclick="hideAddEmployeeModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg transition-all font-medium flex items-center justify-center space-x-2 space-x-reverse">
                            <i class="fas fa-times"></i>
                            <span>إلغاء</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notifications Container -->
    <div id="notifications-container" class="fixed top-4 left-4 z-50 space-y-4"></div>

    <script>
        // Global Variables
        let employees = [];
        let filteredEmployees = [];
        let currentEmployee = null;
        let currentPage = 1;
        const itemsPerPage = 10;
        let sortDirection = 'asc';
        let sortColumn = 'name';
        let generatedForms = 0;
        let charts = {};

        // Theme Management
        function initializeTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
                document.getElementById('theme-icon').className = 'fas fa-sun text-gray-600 dark:text-gray-300';
            }
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                    document.getElementById('theme-icon').className = 'fas fa-sun text-gray-600 dark:text-gray-300';
                } else {
                    document.documentElement.classList.remove('dark');
                    document.getElementById('theme-icon').className = 'fas fa-moon text-gray-600 dark:text-gray-300';
                }
            });
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark');
            if (isDark) {
                document.documentElement.classList.remove('dark');
                document.getElementById('theme-icon').className = 'fas fa-moon text-gray-600 dark:text-gray-300';
            } else {
                document.documentElement.classList.add('dark');
                document.getElementById('theme-icon').className = 'fas fa-sun text-gray-600 dark:text-gray-300';
            }
        }

        // Sidebar Management
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            
            if (sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            } else {
                sidebar.classList.add('open');
                overlay.classList.add('active');
            }
        }

        // Section Management
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active state from nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected section
            const section = document.getElementById(sectionName + '-section');
            if (section) {
                setTimeout(() => {
                    section.classList.add('active');
                }, 100);
            }
            
            // Update page title
            const titles = {
                'dashboard': { title: 'لوحة التحكم', subtitle: 'نظرة عامة على النظام' },
                'employees': { title: 'إدارة الموظفين', subtitle: 'إضافة وتعديل بيانات الموظفين' },
                'forms': { title: 'النماذج والتقارير', subtitle: 'إنشاء وإدارة النماذج الرسمية' },
                'analytics': { title: 'التحليلات والإحصائيات', subtitle: 'تقارير ومعلومات مفصلة' },
                'settings': { title: 'إعدادات النظام', subtitle: 'تخصيص إعدادات النظام والشركة' },
                'backup': { title: 'النسخ الاحتياطي', subtitle: 'إدارة النسخ الاحتياطية للبيانات' }
            };
            
            if (titles[sectionName]) {
                document.getElementById('page-title').textContent = titles[sectionName].title;
                document.getElementById('page-subtitle').textContent = titles[sectionName].subtitle;
            }
            
            // Highlight active nav button
            const navBtn = document.querySelector(`[onclick="showSection('${sectionName}')"]`);
            if (navBtn) {
                navBtn.classList.add('active');
            }
            
            // Close sidebar on mobile
            if (window.innerWidth < 1024) {
                toggleSidebar();
            }
            
            // Load section-specific data if needed
        }

        // Employee Management
        function showAddEmployeeModal() {
            document.getElementById('add-employee-modal').classList.remove('hidden');
            document.getElementById('emp-hire-date').value = new Date().toISOString().split('T')[0];
        }

        function hideAddEmployeeModal() {
            document.getElementById('add-employee-modal').classList.add('hidden');
            document.getElementById('add-employee-form').reset();
        }

        // Form submission
        document.getElementById('add-employee-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const employee = {
                name: document.getElementById('emp-name').value,
                employeeId: document.getElementById('emp-id').value,
                position: document.getElementById('emp-position').value,
                department: document.getElementById('emp-department').value,
                hireDate: document.getElementById('emp-hire-date').value,
                salary: document.getElementById('emp-salary').value || '',
                nationalId: document.getElementById('emp-national-id').value,
                email: document.getElementById('emp-email').value,
                phone: document.getElementById('emp-phone').value,
                maritalStatus: document.getElementById('emp-marital-status').value,
                birthDate: document.getElementById('emp-birth-date').value,
                address: document.getElementById('emp-address').value,
                status: 'active',
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            // Validate required fields
            if (!employee.name || !employee.employeeId || !employee.position || !employee.department || !employee.hireDate) {
                showNotification('يرجى ملء جميع الحقول المطلوبة', 'error');
                return;
            }

            // Check for duplicate employee ID
            if (employees.some(emp => emp.employeeId === employee.employeeId)) {
                showNotification('الرقم الوظيفي موجود مسبقاً', 'error');
                return;
            }

            try {
                employees.push(employee);
                updateEmployeesTable();
                updateEmployeeSelect();
                updateDashboardStats();
                updateFilters();
                hideAddEmployeeModal();
                showNotification('تم إضافة الموظف بنجاح', 'success');
                addToActivityLog('تم إضافة موظف جديد: ' + employee.name);
            } catch (error) {
                console.error('Error adding employee:', error);
                showNotification('حدث خطأ في إضافة الموظف', 'error');
            }
        });

        // Excel Import
        document.getElementById('excel-file').addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                importExcel();
            }
        });

        function importExcel() {
            const file = document.getElementById('excel-file').files[0];
            if (!file) {
                showNotification('يرجى اختيار ملف Excel', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet);
                    
                    processImportedData(jsonData);
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    showNotification('خطأ في قراءة ملف Excel', 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        async function processImportedData(data) {
            try {
                let successCount = 0;
                let errorCount = 0;

                for (const row of data) {
                    const employee = {
                        name: row['الاسم'] || row['Name'] || '',
                        employeeId: row['الرقم الوظيفي'] || row['Employee ID'] || '',
                        position: row['المسمى الوظيفي'] || row['Position'] || '',
                        department: row['القسم'] || row['Department'] || '',
                        hireDate: row['تاريخ التعيين'] || row['Hire Date'] || '',
                        salary: row['الراتب'] || row['Salary'] || '',
                        nationalId: row['رقم الهوية'] || row['National ID'] || '',
                        email: row['البريد الإلكتروني'] || row['Email'] || '',
                        phone: row['رقم الهاتف'] || row['Phone'] || '',
                        maritalStatus: row['الحالة الاجتماعية'] || row['Marital Status'] || '',
                        birthDate: row['تاريخ الميلاد'] || row['Birth Date'] || '',
                        address: row['العنوان'] || row['Address'] || '',
                        status: 'active',
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };

                    if (employee.name && employee.employeeId && !employees.some(emp => emp.employeeId === employee.employeeId)) {
                        employees.push(employee);
                        successCount++;
                    } else {
                        errorCount++;
                    }
                }

                updateEmployeesTable();
                updateEmployeeSelect();
                updateDashboardStats();
                updateFilters();
                showNotification(`تم استيراد ${successCount} موظف بنجاح${errorCount > 0 ? `، فشل في ${errorCount} موظف` : ''}`, 'success');
                addToActivityLog(`تم استيراد ${successCount} موظف من ملف Excel`);
            } catch (error) {
                console.error('Error importing data:', error);
                showNotification('حدث خطأ في استيراد البيانات', 'error');
            }
        }

        // Export to Excel
        function exportEmployeesToExcel() {
            const data = employees.map(emp => ({
                'الاسم': emp.name,
                'الرقم الوظيفي': emp.employeeId,
                'المسمى الوظيفي': emp.position,
                'القسم': emp.department,
                'تاريخ التعيين': formatDate(emp.hireDate),
                'الراتب': emp.salary,
                'رقم الهوية': emp.nationalId,
                'البريد الإلكتروني': emp.email,
                'رقم الهاتف': emp.phone,
                'الحالة الاجتماعية': emp.maritalStatus,
                'تاريخ الميلاد': formatDate(emp.birthDate),
                'العنوان': emp.address,
                'الحالة': emp.status === 'active' ? 'نشط' : 'غير نشط'
            }));

            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'الموظفين');
            
            XLSX.writeFile(workbook, `موظفين_${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('تم تصدير البيانات بنجاح', 'success');
        }

        // Search and Filter
        document.getElementById('search-employees').addEventListener('input', filterEmployees);
        document.getElementById('filter-department').addEventListener('change', filterEmployees);
        document.getElementById('filter-position').addEventListener('change', filterEmployees);
        document.getElementById('filter-status').addEventListener('change', filterEmployees);

        function filterEmployees() {
            const searchTerm = document.getElementById('search-employees').value.toLowerCase();
            const departmentFilter = document.getElementById('filter-department').value;
            const positionFilter = document.getElementById('filter-position').value;
            const statusFilter = document.getElementById('filter-status').value;

            filteredEmployees = employees.filter(employee => {
                const matchesSearch = employee.name.toLowerCase().includes(searchTerm) ||
                                    employee.employeeId.toLowerCase().includes(searchTerm) ||
                                    employee.position.toLowerCase().includes(searchTerm);
                const matchesDepartment = !departmentFilter || employee.department === departmentFilter;
                const matchesPosition = !positionFilter || employee.position === positionFilter;
                const matchesStatus = !statusFilter || employee.status === statusFilter;

                return matchesSearch && matchesDepartment && matchesPosition && matchesStatus;
            });

            currentPage = 1;
            updateEmployeesTable();
        }

        // Table sorting
        function sortTable(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }

            filteredEmployees.sort((a, b) => {
                let aValue = a[column] || '';
                let bValue = b[column] || '';
                
                if (typeof aValue === 'string') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                }

                if (sortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });

            updateEmployeesTable();
        }

        // Pagination
        function nextPage() {
            const totalPages = Math.ceil(filteredEmployees.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                updateEmployeesTable();
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                updateEmployeesTable();
            }
        }

        function goToPage(page) {
            currentPage = page;
            updateEmployeesTable();
        }

        // Update UI functions
        function updateEmployeesTable() {
            const tbody = document.getElementById('employees-table-body');
            tbody.innerHTML = '';

            const dataToShow = filteredEmployees.length > 0 ? filteredEmployees : employees;
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = dataToShow.slice(startIndex, endIndex);

            pageData.forEach((employee, index) => {
                const actualIndex = dataToShow.indexOf(employee);
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700 transition-all';
                
                const statusClass = employee.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' :
                                  employee.status === 'on-leave' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300' :
                                  'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300';
                
                const statusText = employee.status === 'active' ? 'نشط' :
                                 employee.status === 'on-leave' ? 'في إجازة' : 'غير نشط';

                row.innerHTML = `
                    <td class="px-4 py-4">
                        <input type="checkbox" class="employee-checkbox rounded border-gray-300" value="${actualIndex}">
                    </td>
                    <td class="px-4 py-4 font-medium text-gray-900 dark:text-white">
                        <div class="flex items-center space-x-3 space-x-reverse">
                            <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary text-white rounded-full flex items-center justify-center text-sm font-bold">
                                ${employee.name.charAt(0)}
                            </div>
                            <span>${employee.name}</span>
                        </div>
                    </td>
                    <td class="px-4 py-4 text-gray-900 dark:text-gray-300">${employee.employeeId}</td>
                    <td class="px-4 py-4 text-gray-900 dark:text-gray-300">${employee.position}</td>
                    <td class="px-4 py-4 text-gray-900 dark:text-gray-300">${employee.department}</td>
                    <td class="px-4 py-4 text-gray-900 dark:text-gray-300">${formatDate(employee.hireDate)}</td>
                    <td class="px-4 py-4">
                        <span class="px-2 py-1 text-xs rounded-full ${statusClass}">${statusText}</span>
                    </td>
                    <td class="px-4 py-4">
                        <div class="flex space-x-2 space-x-reverse">
                            <button onclick="editEmployee(${actualIndex})" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all" title="تعديل">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteEmployee(${actualIndex})" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-all" title="حذف">
                                <i class="fas fa-trash"></i>
                            </button>
                            <button onclick="viewEmployee(${actualIndex})" class="text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300 p-2 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/20 transition-all" title="عرض">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updatePagination(dataToShow.length);
        }

        function updatePagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);

            document.getElementById('showing-from').textContent = startItem;
            document.getElementById('showing-to').textContent = endItem;
            document.getElementById('total-records').textContent = totalItems;

            // Update pagination buttons
            document.getElementById('prev-btn').disabled = currentPage === 1;
            document.getElementById('next-btn').disabled = currentPage === totalPages;

            // Update page numbers
            const pageNumbers = document.getElementById('page-numbers');
            pageNumbers.innerHTML = '';

            const maxPagesToShow = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
            let endPage = Math.min(totalPages, startPage + maxPagesToShow - 1);

            if (endPage - startPage < maxPagesToShow - 1) {
                startPage = Math.max(1, endPage - maxPagesToShow + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.textContent = i;
                pageBtn.className = `px-3 py-2 text-sm rounded-lg transition-colors ${i === currentPage ? 'bg-primary text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600'}`;
                pageBtn.onclick = () => goToPage(i);
                pageNumbers.appendChild(pageBtn);
            }
        }

        function updateEmployeeSelect() {
            const select = document.getElementById('employee-select');
            select.innerHTML = '<option value="">اختر موظف...</option>';

            employees.forEach((employee, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${employee.name} - ${employee.employeeId}`;
                select.appendChild(option);
            });
        }

        function updateFilters() {
            const departments = [...new Set(employees.map(emp => emp.department))].filter(Boolean);
            const positions = [...new Set(employees.map(emp => emp.position))].filter(Boolean);

            updateSelectOptions('filter-department', departments);
            updateSelectOptions('filter-position', positions);
        }

        function updateSelectOptions(selectId, options) {
            const select = document.getElementById(selectId);
            const currentValue = select.value;
            
            // Keep the first option (All)
            const firstOption = select.children[0];
            select.innerHTML = '';
            select.appendChild(firstOption);

            options.forEach(option => {
                const optionElement = document.createElement('option');
                optionElement.value = option;
                optionElement.textContent = option;
                select.appendChild(optionElement);
            });

            select.value = currentValue;
        }

        function updateDashboardStats() {
            document.getElementById('total-employees').textContent = employees.length;
            document.getElementById('total-forms').textContent = generatedForms;
            document.getElementById('new-employees').textContent = employees.filter(emp => {
                const hireDate = new Date(emp.hireDate);
                const thirtyDaysAgo = new Date();
                thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
                return hireDate >= thirtyDaysAgo;
            }).length;
        }

        // Employee actions
        function editEmployee(index) {
            showNotification('وظيفة التعديل قيد التطوير', 'info');
        }

        function deleteEmployee(index) {
            showConfirmDialog(
                'هل أنت متأكد من حذف هذا الموظف؟ هذا الإجراء لا يمكن التراجع عنه.',
                () => {
                    employees.splice(index, 1);
                    updateEmployeesTable();
                    updateEmployeeSelect();
                    updateDashboardStats();
                    updateFilters();
                    showNotification('تم حذف الموظف بنجاح', 'success');
                    addToActivityLog('تم حذف موظف من النظام');
                }
            );
        }

        function viewEmployee(index) {
            showNotification('وظيفة العرض قيد التطوير', 'info');
        }

        // Form Generation Functions
        function generateForm(formType) {
            const selectedIndex = document.getElementById('employee-select').value;
            if (!selectedIndex) {
                showNotification('يرجى اختيار موظف أولاً', 'error');
                return;
            }

            currentEmployee = employees[selectedIndex];
            const preview = document.getElementById('form-preview');
            
            switch(formType) {
                case 'start-work':
                    preview.innerHTML = generateStartWorkForm(currentEmployee);
                    break;
                case 'vacation':
                    preview.innerHTML = generateVacationForm(currentEmployee);
                    break;
                case 'salary-certificate':
                    preview.innerHTML = generateSalaryCertificateForm(currentEmployee);
                    break;
                case 'experience-certificate':
                    preview.innerHTML = generateExperienceCertificateForm(currentEmployee);
                    break;
                case 'vacation-annual':
                    preview.innerHTML = generateAnnualVacationForm(currentEmployee);
                    break;
                case 'vacation-sick':
                    preview.innerHTML = generateSickVacationForm(currentEmployee);
                    break;
                case 'vacation-unpaid':
                    preview.innerHTML = generateUnpaidVacationForm(currentEmployee);
                    break;
                case 'custody-receive':
                    preview.innerHTML = generateCustodyReceiveForm(currentEmployee);
                    break;
                case 'custody-handover':
                    preview.innerHTML = generateCustodyHandoverForm(currentEmployee);
                    break;
                case 'service-termination':
                    preview.innerHTML = generateServiceTerminationForm(currentEmployee);
                    break;
                case 'resignation':
                    preview.innerHTML = generateResignationForm(currentEmployee);
                    break;
            }

            generatedForms++;
            updateDashboardStats();
            addToActivityLog(`تم إنشاء نموذج ${getFormTypeName(formType)} للموظف ${currentEmployee.name}`);
        }

        function getFormTypeName(formType) {
            const names = {
                'start-work': 'مباشرة عمل',
                'vacation': 'طلب إجازة',
                'salary-certificate': 'شهادة راتب',
                'experience-certificate': 'شهادة خبرة',
                'vacation-annual': 'إجازة سنوية',
                'vacation-sick': 'إجازة مرضية',
                'vacation-unpaid': 'إجازة بدون راتب',
                'custody-receive': 'استلام عهدة',
                'custody-handover': 'تسليم عهدة',
                'service-termination': 'إنهاء الخدمات',
                'resignation': 'الاستقالة'
            };
            return names[formType] || formType;
        }

        // Additional Form Templates
        function generateAnnualVacationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">طلب إجازة سنوية</h1>
                        <p class="text-gray-600">نموذج طلب إجازة سنوية رسمي</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم الطلب: AV-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ الطلب', formatDate(new Date()))}
                            ${generateInfoField('رصيد الإجازة المتبقي', '__________ يوم')}
                            ${generateInfoField('آخر إجازة سنوية', '__________')}
                        </div>
                    </div>

                    <div class="bg-teal-50 p-6 rounded-lg border-r-4 border-teal-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-teal-800">تفاصيل الإجازة السنوية</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                ${generateEditableField('تاريخ بداية الإجازة')}
                                ${generateEditableField('تاريخ نهاية الإجازة')}
                                ${generateEditableField('عدد أيام الإجازة المطلوبة')}
                                ${generateEditableField('تاريخ استئناف العمل')}
                            </div>
                            <div class="space-y-4">
                                ${generateEditableField('سبب الإجازة')}
                                ${generateEditableField('عنوان الاتصال أثناء الإجازة')}
                                ${generateEditableField('رقم الهاتف أثناء الإجازة')}
                                ${generateEditableField('بديل الموظف في العمل')}
                            </div>
                        </div>
                    </div>

                    ${generateFormFooter(true)}
                </div>
            `;
        }

        function generateSickVacationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">طلب إجازة مرضية</h1>
                        <p class="text-gray-600">نموذج طلب إجازة مرضية رسمي</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم الطلب: SV-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ الطلب', formatDate(new Date()))}
                            ${generateInfoField('رصيد الإجازة المرضية', '__________ يوم')}
                            ${generateInfoField('آخر إجازة مرضية', '__________')}
                        </div>
                    </div>

                    <div class="bg-red-50 p-6 rounded-lg border-r-4 border-red-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-red-800">تفاصيل الإجازة المرضية</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                ${generateEditableField('تاريخ بداية الإجازة')}
                                ${generateEditableField('تاريخ نهاية الإجازة')}
                                ${generateEditableField('عدد أيام الإجازة')}
                                ${generateEditableField('تاريخ الكشف الطبي')}
                            </div>
                            <div class="space-y-4">
                                ${generateEditableField('اسم الطبيب')}
                                ${generateEditableField('اسم المستشفى/العيادة')}
                                ${generateEditableField('رقم التقرير الطبي')}
                                ${generateEditableField('طبيعة المرض')}
                            </div>
                        </div>
                        <div class="mt-6">
                            <p class="text-sm text-red-700 font-medium">ملاحظة: يجب إرفاق التقرير الطبي مع هذا الطلب</p>
                        </div>
                    </div>

                    ${generateFormFooter(true)}
                </div>
            `;
        }

        function generateUnpaidVacationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">طلب إجازة بدون راتب</h1>
                        <p class="text-gray-600">نموذج طلب إجازة بدون راتب رسمي</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم الطلب: UV-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ الطلب', formatDate(new Date()))}
                            ${generateInfoField('سنوات الخدمة', calculateExperience(employee.hireDate))}
                            ${generateInfoField('التقييم الأخير', '__________')}
                        </div>
                    </div>

                    <div class="bg-orange-50 p-6 rounded-lg border-r-4 border-orange-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-orange-800">تفاصيل الإجازة بدون راتب</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                ${generateEditableField('تاريخ بداية الإجازة')}
                                ${generateEditableField('تاريخ نهاية الإجازة')}
                                ${generateEditableField('المدة المطلوبة')}
                                ${generateEditableField('تاريخ استئناف العمل')}
                            </div>
                            <div class="space-y-4">
                                ${generateEditableField('سبب طلب الإجازة')}
                                ${generateEditableField('عنوان الإقامة أثناء الإجازة')}
                                ${generateEditableField('رقم الهاتف للاتصال')}
                                ${generateEditableField('البديل المقترح')}
                            </div>
                        </div>
                        <div class="mt-6">
                            <p class="text-sm text-orange-700 font-medium">ملاحظة: الإجازة بدون راتب تخضع لموافقة الإدارة العليا</p>
                        </div>
                    </div>

                    ${generateFormFooter(true)}
                </div>
            `;
        }

        function generateCustodyReceiveForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">محضر استلام عهدة</h1>
                        <p class="text-gray-600">محضر رسمي لاستلام العهدات والأصول</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم المحضر: CR-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم المستلم', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ الاستلام', formatDate(new Date()))}
                            ${generateInfoField('اسم المسلم', '__________')}
                            ${generateInfoField('المسؤول عن العهدة', '__________')}
                            ${generateInfoField('مكان الاستلام', '__________')}
                        </div>
                    </div>

                    <div class="bg-cyan-50 p-6 rounded-lg border-r-4 border-cyan-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-cyan-800">تفاصيل العهدات المستلمة</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border border-gray-300">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="border border-gray-300 p-3 text-right">م</th>
                                        <th class="border border-gray-300 p-3 text-right">اسم الصنف</th>
                                        <th class="border border-gray-300 p-3 text-right">رقم المسلسل</th>
                                        <th class="border border-gray-300 p-3 text-right">الحالة</th>
                                        <th class="border border-gray-300 p-3 text-right">القيمة</th>
                                        <th class="border border-gray-300 p-3 text-right">ملاحظات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${[1,2,3,4,5].map(i => `
                                    <tr>
                                        <td class="border border-gray-300 p-3">${i}</td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                    </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-yellow-50 p-4 rounded-lg border-r-4 border-yellow-500 mb-8">
                        <p class="text-sm text-yellow-800 font-medium">
                            تعهد: أتعهد بالمحافظة على العهدات المذكورة أعلاه وإعادتها عند انتهاء الخدمة أو عند الطلب في حالة جيدة، وأتحمل مسؤولية أي ضرر أو فقدان يحدث لها.
                        </p>
                    </div>

                    ${generateFormFooter(false)}
                </div>
            `;
        }

        function generateCustodyHandoverForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">محضر تسليم عهدة</h1>
                        <p class="text-gray-600">محضر رسمي لتسليم العهدات والأصول</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم المحضر: CH-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم المسلم', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التسليم', formatDate(new Date()))}
                            ${generateInfoField('اسم المستلم', '__________')}
                            ${generateInfoField('المسؤول عن الاستلام', '__________')}
                            ${generateInfoField('مكان التسليم', '__________')}
                        </div>
                    </div>

                    <div class="bg-amber-50 p-6 rounded-lg border-r-4 border-amber-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-amber-800">تفاصيل العهدات المسلمة</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border border-gray-300">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="border border-gray-300 p-3 text-right">م</th>
                                        <th class="border border-gray-300 p-3 text-right">اسم الصنف</th>
                                        <th class="border border-gray-300 p-3 text-right">رقم المسلسل</th>
                                        <th class="border border-gray-300 p-3 text-right">حالة التسليم</th>
                                        <th class="border border-gray-300 p-3 text-right">القيمة</th>
                                        <th class="border border-gray-300 p-3 text-right">ملاحظات</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${[1,2,3,4,5].map(i => `
                                    <tr>
                                        <td class="border border-gray-300 p-3">${i}</td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                        <td class="border border-gray-300 p-3 h-10"></td>
                                    </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="bg-green-50 p-4 rounded-lg border-r-4 border-green-500 mb-8">
                        <p class="text-sm text-green-800 font-medium">
                            إقرار: أقر بأنني قمت بتسليم جميع العهدات المذكورة أعلاه في حالة جيدة وأنني لست مسؤولاً عنها بعد تاريخ التسليم المذكور.
                        </p>
                    </div>

                    ${generateFormFooter(false)}
                </div>
            `;
        }

        function generateServiceTerminationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">قرار إنهاء الخدمات</h1>
                        <p class="text-gray-600">قرار رسمي بإنهاء خدمات الموظف</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم القرار: ST-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ إنهاء الخدمة', formatDate(new Date()))}
                            ${generateInfoField('مدة الخدمة', calculateExperience(employee.hireDate))}
                            ${generateInfoField('تاريخ آخر يوم عمل', '__________')}
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg border-r-4 border-gray-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-gray-800">تفاصيل إنهاء الخدمة</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">سبب إنهاء الخدمة</label>
                                    <div class="space-y-2">
                                        ${generateCheckbox('انتهاء العقد')}
                                        ${generateCheckbox('استقالة')}
                                        ${generateCheckbox('فصل تأديبي')}
                                        ${generateCheckbox('تقاعد')}
                                        ${generateCheckbox('عدم تجديد العقد')}
                                        ${generateEditableField('أسباب أخرى')}
                                    </div>
                                </div>
                            </div>
                            <div class="space-y-4">
                                ${generateEditableField('مدة الإشعار')}
                                ${generateEditableField('المستحقات المالية')}
                                ${generateEditableField('بدل إجازات غير مستحقة')}
                                ${generateEditableField('مكافأة نهاية الخدمة')}
                            </div>
                        </div>
                    </div>

                    <div class="bg-red-50 p-4 rounded-lg border-r-4 border-red-500 mb-8">
                        <p class="text-sm text-red-800 font-medium">
                            ملاحظة: يجب على الموظف تسليم جميع العهدات والأصول والمستندات الخاصة بالشركة قبل تاريخ انتهاء الخدمة.
                        </p>
                    </div>

                    ${generateFormFooter(false)}
                </div>
            `;
        }

        function generateResignationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">طلب استقالة</h1>
                        <p class="text-gray-600">طلب رسمي للاستقالة من العمل</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم الطلب: RS-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ تقديم الاستقالة', formatDate(new Date()))}
                            ${generateInfoField('مدة الخدمة', calculateExperience(employee.hireDate))}
                            ${generateInfoField('رقم الهوية', employee.nationalId || 'غير محدد')}
                        </div>
                    </div>

                    <div class="bg-rose-50 p-6 rounded-lg border-r-4 border-rose-500 mb-8">
                        <h3 class="font-bold text-lg mb-6 text-rose-800">تفاصيل الاستقالة</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                ${generateEditableField('تاريخ الاستقالة المطلوب')}
                                ${generateEditableField('آخر يوم عمل')}
                                ${generateEditableField('مدة الإشعار')}
                                ${generateEditableField('سبب الاستقالة')}
                            </div>
                            <div class="space-y-4">
                                ${generateEditableField('الوظيفة الجديدة (إن وجدت)')}
                                ${generateEditableField('جهة العمل الجديدة')}
                                ${generateEditableField('عنوان الاتصال بعد الاستقالة')}
                                ${generateEditableField('رقم الهاتف للمتابعة')}
                            </div>
                        </div>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-lg border-r-4 border-blue-500 mb-8">
                        <h3 class="font-bold text-lg mb-4 text-blue-800">التزامات ما بعد الاستقالة</h3>
                        <div class="space-y-3">
                            ${generateCheckbox('تسليم جميع العهدات والأصول')}
                            ${generateCheckbox('تسليم جميع المستندات والملفات')}
                            ${generateCheckbox('إلغاء الصلاحيات والوصول للأنظمة')}
                            ${generateCheckbox('تسوية المستحقات المالية')}
                            ${generateCheckbox('إعادة بطاقة الموظف ومفاتيح المكاتب')}
                        </div>
                    </div>

                    <div class="mb-8">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ملاحظات إضافية</label>
                        <div class="h-20 border-2 border-gray-300 rounded p-3 bg-white"></div>
                    </div>

                    ${generateFormFooter(true)}
                </div>
            `;
        }

        // Form Templates
        function generateStartWorkForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            const companyAddress = document.getElementById('company-address')?.value || 'الرياض، المملكة العربية السعودية';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName, companyAddress)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">إشعار مباشرة عمل</h1>
                        <p class="text-gray-600">إشعار رسمي ببدء الخدمة</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم المستند: SW-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('الاسم الكامل', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ المباشرة', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ الإصدار', formatDate(new Date()))}
                            ${generateInfoField('رقم الهوية', employee.nationalId || 'غير محدد')}
                            ${generateInfoField('الراتب الأساسي', employee.salary ? employee.salary + ' ريال' : 'غير محدد')}
                        </div>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-lg border-r-4 border-blue-500 mb-8">
                        <p class="text-lg leading-relaxed text-gray-800">
                            نشهد بأن الموظف/ة <strong class="text-blue-800">${employee.name}</strong> حامل/ة الرقم الوظيفي 
                            <strong class="text-blue-800">${employee.employeeId}</strong> قد باشر/ت العمل في منصب 
                            <strong class="text-blue-800">${employee.position}</strong> بقسم <strong class="text-blue-800">${employee.department}</strong>
                            اعتباراً من تاريخ <strong class="text-blue-800">${formatDate(employee.hireDate)}</strong> وفقاً للأنظمة واللوائح المعمول بها.
                        </p>
                    </div>

                    ${generateFormFooter()}
                </div>
            `;
        }

        function generateVacationForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">طلب إجازة</h1>
                        <p class="text-gray-600">نموذج طلب إجازة رسمي</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم الطلب: VR-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="space-y-4">
                            ${generateInfoField('اسم الموظف', employee.name)}
                            ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                            ${generateInfoField('المسمى الوظيفي', employee.position)}
                            ${generateInfoField('القسم', employee.department)}
                        </div>
                        <div class="space-y-4">
                            ${generateInfoField('تاريخ التعيين', formatDate(employee.hireDate))}
                            ${generateInfoField('تاريخ الطلب', formatDate(new Date()))}
                            ${generateInfoField('رقم الهاتف', employee.phone || 'غير محدد')}
                            ${generateInfoField('البريد الإلكتروني', employee.email || 'غير محدد')}
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg mb-8">
                        <h3 class="font-bold text-lg mb-6 text-gray-800">تفاصيل الإجازة</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                ${generateEditableField('تاريخ بداية الإجازة')}
                                ${generateEditableField('تاريخ نهاية الإجازة')}
                                ${generateEditableField('عدد أيام الإجازة')}
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">نوع الإجازة</label>
                                    <div class="space-y-2">
                                        ${generateCheckbox('إجازة سنوية')}
                                        ${generateCheckbox('إجازة مرضية')}
                                        ${generateCheckbox('إجازة طارئة')}
                                        ${generateCheckbox('إجازة أمومة')}
                                        ${generateCheckbox('إجازة حج')}
                                        ${generateEditableField('أخرى')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    ${generateFormFooter(true)}
                </div>
            `;
        }

        function generateSalaryCertificateForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">شهادة راتب</h1>
                        <p class="text-gray-600">إثبات راتب رسمي</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم المستند: SC-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="bg-green-50 p-6 rounded-lg border-r-4 border-green-500 mb-8">
                        <p class="text-lg leading-relaxed text-gray-800">
                            نشهد بأن الموظف/ة <strong class="text-green-800">${employee.name}</strong> 
                            حامل/ة الرقم الوظيفي <strong class="text-green-800">${employee.employeeId}</strong>
                            يعمل/تعمل لدينا في منصب <strong class="text-green-800">${employee.position}</strong>
                            بقسم <strong class="text-green-800">${employee.department}</strong> منذ تاريخ 
                            <strong class="text-green-800">${formatDate(employee.hireDate)}</strong>.
                        </p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <h3 class="font-bold text-lg mb-4 text-gray-800">بيانات الموظف</h3>
                            <div class="space-y-3">
                                ${generateInfoField('الاسم', employee.name)}
                                ${generateInfoField('الرقم الوظيفي', employee.employeeId)}
                                ${generateInfoField('المسمى الوظيفي', employee.position)}
                                ${generateInfoField('القسم', employee.department)}
                            </div>
                        </div>

                        <div class="bg-white border border-gray-200 rounded-lg p-6">
                            <h3 class="font-bold text-lg mb-4 text-gray-800">تفاصيل الراتب</h3>
                            <div class="space-y-3">
                                ${generateInfoField('الراتب الأساسي', (employee.salary || 'غير محدد') + ' ريال')}
                                ${generateInfoField('بدل السكن', '__________ ريال')}
                                ${generateInfoField('بدل المواصلات', '__________ ريال')}
                                ${generateInfoField('إجمالي الراتب', '__________ ريال')}
                            </div>
                        </div>
                    </div>

                    ${generateFormFooter()}
                </div>
            `;
        }

        function generateExperienceCertificateForm(employee) {
            const companyName = document.getElementById('company-name')?.value || 'شركة التقنية المتطورة';
            const experienceYears = calculateExperience(employee.hireDate);
            
            return `
                <div class="max-w-4xl mx-auto bg-white p-8 print:p-6">
                    ${generateFormHeader(companyName)}
                    
                    <div class="mb-8 text-center">
                        <h1 class="text-3xl font-bold text-gray-800 mb-2">شهادة خبرة</h1>
                        <p class="text-gray-600">إثبات خبرة مهنية</p>
                        <div class="mt-4 text-sm text-gray-500">
                            رقم المستند: EC-${employee.employeeId}-${new Date().getFullYear()}
                        </div>
                    </div>

                    <div class="bg-purple-50 p-6 rounded-lg border-r-4 border-purple-500 mb-8">
                        <p class="text-lg leading-relaxed text-gray-800">
                            نشهد بأن <strong class="text-purple-800">${employee.name}</strong> 
                            حامل/ة الرقم الوظيفي <strong class="text-purple-800">${employee.employeeId}</strong>
                            قد عمل/ت لدى <strong class="text-purple-800">${companyName}</strong>
                            في منصب <strong class="text-purple-800">${employee.position}</strong>
                            بقسم <strong class="text-purple-800">${employee.department}</strong>
                            لمدة <strong class="text-purple-800">${experienceYears}</strong>
                            من تاريخ <strong class="text-purple-800">${formatDate(employee.hireDate)}</strong>
                            وحتى تاريخ <strong class="text-purple-800">${formatDate(new Date())}</strong>.
                        </p>
                    </div>

                    ${generateFormFooter()}
                </div>
            `;
        }

        // Helper functions for form generation
        function generateFormHeader(companyName, companyAddress) {
            return `
                <div class="text-center mb-8 border-b-2 border-gray-200 pb-6">
                    <div class="flex items-center justify-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center ml-4">
                            <i class="fas fa-building text-white text-2xl"></i>
                        </div>
                        <div class="text-right">
                            <h2 class="text-2xl font-bold text-gray-800">${companyName}</h2>
                            <p class="text-gray-600">${companyAddress || ''}</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateInfoField(label, value) {
            return `
                <div class="flex justify-between border-b pb-2">
                    <span class="font-semibold text-gray-600">${label}:</span>
                    <span class="text-gray-900">${value}</span>
                </div>
            `;
        }

        function generateEditableField(label) {
            return `
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">${label}</label>
                    <div class="h-10 border-2 border-gray-300 rounded p-2 bg-white"></div>
                </div>
            `;
        }

        function generateCheckbox(label) {
            return `
                <label class="flex items-center">
                    <input type="checkbox" class="rounded border-gray-300 ml-2">
                    <span class="text-sm">${label}</span>
                </label>
            `;
        }

        function generateFormFooter(showApprovals = false) {
            return `
                <div class="mt-12 pt-8 border-t-2 border-gray-200">
                    <div class="grid ${showApprovals ? 'md:grid-cols-3' : 'md:grid-cols-2'} gap-8">
                        <div class="text-center">
                            <div class="mb-4 font-semibold text-gray-800">توقيع الموظف</div>
                            <div class="h-16 border-b-2 border-gray-400 mb-2"></div>
                            <div class="text-sm text-gray-600">التاريخ: ___________</div>
                        </div>
                        ${showApprovals ? `
                        <div class="text-center">
                            <div class="mb-4 font-semibold text-gray-800">توقيع المدير المباشر</div>
                            <div class="h-16 border-b-2 border-gray-400 mb-2"></div>
                            <div class="text-sm text-gray-600">التاريخ: ___________</div>
                        </div>
                        ` : ''}
                        <div class="text-center">
                            <div class="mb-4 font-semibold text-gray-800">اعتماد الموارد البشرية</div>
                            <div class="h-16 border-b-2 border-gray-400 mb-2"></div>
                            <div class="text-sm text-gray-600">التاريخ: ___________</div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-8">
                        <div class="w-24 h-24 border-2 border-gray-400 rounded-full mx-auto mb-2"></div>
                        <div class="text-sm text-gray-600">الختم الرسمي</div>
                    </div>
                </div>
            `;
        }

        // Export and save functions
        function saveForm() {
            if (!currentEmployee) {
                showNotification('لا يوجد نموذج لحفظه', 'error');
                return;
            }
            
            const formData = {
                employee: currentEmployee,
                content: document.getElementById('form-preview').innerHTML,
                timestamp: new Date().toISOString(),
                type: 'saved_form'
            };

            localStorage.setItem(`form_${Date.now()}`, JSON.stringify(formData));
            showNotification('تم حفظ النموذج بنجاح', 'success');
        }

        async function exportToPDF() {
            if (!currentEmployee) {
                showNotification('يرجى توليد نموذج أولاً', 'error');
                return;
            }

            try {
                const element = document.getElementById('form-preview');
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true
                });

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                doc.save(`نموذج_${currentEmployee.name}_${new Date().toISOString().split('T')[0]}.pdf`);
                showNotification('تم تصدير PDF بنجاح', 'success');
            } catch (error) {
                console.error('Error exporting PDF:', error);
                showNotification('حدث خطأ في تصدير PDF', 'error');
            }
        }

        function printForm() {
            if (!currentEmployee) {
                showNotification('يرجى توليد نموذج أولاً', 'error');
                return;
            }
            window.print();
        }

        function exportAllData() {
            const worksheet = XLSX.utils.json_to_sheet(employees);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'الموظفين');
            
            XLSX.writeFile(workbook, `تقرير_شامل_${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('تم تصدير البيانات الشاملة بنجاح', 'success');
        }

        // Backup functions
        function createBackup() {
            const backupData = {
                employees: employees,
                settings: {
                    companyName: document.getElementById('company-name')?.value || 'شركة التقنية المتطورة',
                    companyAddress: document.getElementById('company-address')?.value || 'الرياض، المملكة العربية السعودية',
                    companyPhone: document.getElementById('company-phone')?.value || '920000000',
                    companyEmail: document.getElementById('company-email')?.value || 'info@company.com'
                },
                timestamp: new Date().toISOString(),
                version: '1.0'
            };

            const dataStr = JSON.stringify(backupData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `hr_backup_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('تم إنشاء النسخة الاحتياطية بنجاح', 'success');
        }

        document.getElementById('backup-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        restoreFromBackup(backupData);
                    } catch (error) {
                        showNotification('ملف النسخة الاحتياطية غير صحيح', 'error');
                    }
                };
                reader.readAsText(file);
            }
        });

        function restoreFromBackup(backupData) {
            showConfirmDialog(
                'هل أنت متأكد من استعادة النسخة الاحتياطية؟ سيتم استبدال جميع البيانات الحالية.',
                () => {
                    employees = backupData.employees || [];
                    
                    if (backupData.settings) {
                        if (document.getElementById('company-name')) {
                            document.getElementById('company-name').value = backupData.settings.companyName;
                        }
                        if (document.getElementById('company-address')) {
                            document.getElementById('company-address').value = backupData.settings.companyAddress;
                        }
                        if (document.getElementById('company-phone')) {
                            document.getElementById('company-phone').value = backupData.settings.companyPhone;
                        }
                        if (document.getElementById('company-email')) {
                            document.getElementById('company-email').value = backupData.settings.companyEmail;
                        }
                    }
                    
                    updateEmployeesTable();
                    updateEmployeeSelect();
                    updateDashboardStats();
                    updateFilters();
                    
                    showNotification('تم استعادة النسخة الاحتياطية بنجاح', 'success');
                    addToActivityLog('تم استعادة نسخة احتياطية');
                }
            );
        }

        // Analytics and Charts
        function initializeCharts() {
            // Department distribution chart
            const departmentData = {};
            employees.forEach(emp => {
                departmentData[emp.department] = (departmentData[emp.department] || 0) + 1;
            });

            if (document.getElementById('department-chart')) {
                const deptChart = new Chart(document.getElementById('department-chart'), {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(departmentData),
                        datasets: [{
                            data: Object.values(departmentData),
                            backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe'],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
                charts.departmentChart = deptChart;
            }

            // Forms generation chart
            if (document.getElementById('forms-chart')) {
                const formsChart = new Chart(document.getElementById('forms-chart'), {
                    type: 'line',
                    data: {
                        labels: ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو'],
                        datasets: [{
                            label: 'النماذج المولدة',
                            data: [12, 19, 15, 25, 22, 30],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                charts.formsChart = formsChart;
            }

            // Quick chart for dashboard
            if (document.getElementById('quick-chart')) {
                const quickChart = new Chart(document.getElementById('quick-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['موظفين', 'نماذج', 'إجازات'],
                        datasets: [{
                            data: [employees.length, generatedForms, 5],
                            backgroundColor: ['#667eea', '#764ba2', '#f093fb'],
                            borderRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
                charts.quickChart = quickChart;
            }
        }

        // Utility Functions
        function formatDate(date) {
            if (!date) return '';
            const d = new Date(date);
            return d.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
        }

        function calculateExperience(hireDate) {
            if (!hireDate) return 'غير محدد';
            
            const hire = new Date(hireDate);
            const now = new Date();
            const diffTime = Math.abs(now - hire);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            const years = Math.floor(diffDays / 365);
            const months = Math.floor((diffDays % 365) / 30);
            
            if (years > 0) {
                return `${years} سنة و ${months} شهر`;
            } else {
                return `${months} شهر`;
            }
        }

        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ar-SA', {
                hour: '2-digit',
                minute: '2-digit'
            });
            const dateString = now.toLocaleDateString('ar-SA');
            if (document.getElementById('current-time')) {
                document.getElementById('current-time').textContent = `${timeString} - ${dateString}`;
            }
        }

        // Notification System
        function showNotification(message, type = 'info', duration = 3000) {
            const notification = document.createElement('div');
            notification.className = `notification fixed top-4 left-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full opacity-0`;
            
            const colors = {
                success: 'bg-green-500 text-white',
                error: 'bg-red-500 text-white',
                warning: 'bg-yellow-500 text-white',
                info: 'bg-blue-500 text-white'
            };
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };

            notification.className += ` ${colors[type]}`;
            notification.innerHTML = `
                <div class="flex items-center space-x-3 space-x-reverse">
                    <i class="${icons[type]}"></i>
                    <span>${message}</span>
                    <button onclick="this.closest('.notification').remove()" class="mr-auto text-white hover:text-gray-200">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            document.getElementById('notifications-container').appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full', 'opacity-0');
            }, 100);

            // Auto remove
            setTimeout(() => {
                notification.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full mx-4 animate-scale-in">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-exclamation-triangle text-yellow-500 text-xl ml-3"></i>
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white">تأكيد العملية</h3>
                    </div>
                    <p class="text-gray-700 dark:text-gray-300 mb-6">${message}</p>
                    <div class="flex justify-end space-x-3 space-x-reverse">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors">
                            إلغاء
                        </button>
                        <button onclick="onConfirm(); this.closest('.fixed').remove();" class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded transition-colors">
                            تأكيد
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Activity Log
        function addToActivityLog(activity) {
            const recentActivity = document.getElementById('recent-activity');
            if (recentActivity) {
                const activityItem = document.createElement('div');
                activityItem.className = 'flex items-center space-x-3 space-x-reverse p-3 bg-gray-50 dark:bg-gray-700 rounded-lg animate-fade-in';
                activityItem.innerHTML = `
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <div class="flex-1">
                        <p class="text-sm text-gray-900 dark:text-white">${activity}</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">${new Date().toLocaleTimeString('ar-SA')}</p>
                    </div>
                `;
                
                recentActivity.insertBefore(activityItem, recentActivity.firstChild);
                
                // Keep only last 5 activities
                while (recentActivity.children.length > 5) {
                    recentActivity.removeChild(recentActivity.lastChild);
                }
            }
        }

        // Settings
        document.getElementById('company-settings-form').addEventListener('submit', (e) => {
            e.preventDefault();
            showNotification('تم حفظ إعدادات الشركة بنجاح', 'success');
            addToActivityLog('تم تحديث إعدادات الشركة');
        });

        // Initialize App
        async function initializeApp() {
            try {
                // Initialize theme
                initializeTheme();
                
                // Update time
                updateCurrentTime();
                setInterval(updateCurrentTime, 60000);
                
                // Initialize empty employees array - no sample data
                employees = [];
                
                filteredEmployees = [...employees];
                updateEmployeesTable();
                updateEmployeeSelect();
                updateFilters();
                updateDashboardStats();
                
                // Show dashboard by default
                showSection('dashboard');
                
                // Hide loading screen
                setTimeout(() => {
                    document.getElementById('loading-screen').style.display = 'none';
                }, 1000);
                
                // Add welcome activity
                addToActivityLog('تم تحميل النظام بنجاح');
                
            } catch (error) {
                console.error('Error initializing app:', error);
                showNotification('حدث خطأ في تحميل النظام', 'error');
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', initializeApp);
        
        // Close sidebar when clicking overlay
        document.getElementById('sidebar-overlay').addEventListener('click', toggleSidebar);
        
        // Handle responsive sidebar
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) {
                document.getElementById('sidebar').classList.remove('open');
                document.getElementById('sidebar-overlay').classList.remove('active');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveForm();
                        break;
                    case 'p':
                        e.preventDefault();
                        printForm();
                        break;
                    case 'n':
                        e.preventDefault();
                        showAddEmployeeModal();
                        break;
                }
            }
            
            if (e.key === 'Escape') {
                // Close any open modals
                document.querySelectorAll('.fixed.inset-0').forEach(modal => {
                    if (!modal.classList.contains('hidden')) {
                        modal.classList.add('hidden');
                    }
                });
                
                // Close sidebar if open
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('open')) {
                    toggleSidebar();
                }
            }
        });
    </script>
</body>
</html>
